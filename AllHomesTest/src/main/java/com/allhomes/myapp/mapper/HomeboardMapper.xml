<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.allhomes.myapp.homeboard.HomeboardDaoImp">
  	<!-- 집들이 전체리스트 -->
 	<select id="homeboardAllList"  resultType="com.allhomes.myapp.homeboard.HomeboardVO">
 		select a.b_no, a.thumbnail, a.title, a.userid, b.hb_theme_no, a.hit, a.scrap from homeboard a join hb_theme b on a.theme = b.theme order by b_no desc
 	</select>
  	
  	<!-- 집들이 글작성하기 -->
  	<insert id="homeboardInsert" parameterType="com.allhomes.myapp.homeboard.HomeboardVO">
  	  	insert into homeboard
  	  	(b_no, title, thumbnail, content, theme, hashtag, userid, nickname, hit, scrap, writedate, ip) values
  	  	(homeboard_sq.nextval, #{title}, #{thumbnail}, #{content}, #{theme}, #{hashtag}, #{userid}, #{nickname}, 0, 0, sysdate, #{ip})
  	</insert>
  	

  	<!-- 집들이 글내용보기 -->
  	<select id="homeboardSelect" parameterType="int" resultType="com.allhomes.myapp.homeboard.HomeboardVO">
  		select b_no, userid, title, content, theme, hashtag, hit, scrap, to_char(writedate, 'YYYY-MM-DD HH24:MI') writedate
  		from homeboard where b_no=#{param1}
  	</select>
  	
  	<!-- 집들이 글번호꺼내기 -->
     <select id="getHomeboardNumber" resultType="int">
        select nvl(max(b_no), 1) from homeboard
     </select>
     
    <!-- 집들이 테마별로 리스트 -->
    <select id="homeboardThemeList" parameterType="int" resultType="com.allhomes.myapp.homeboard.HomeboardVO">
    	select a.b_no, a.thumbnail, a.title, a.userid, b.hb_theme_no, a.hit, a.scrap from homeboard a join hb_theme b on a.theme = b.theme where hb_theme_no=#{param1} order by b_no desc
    </select>
    
    <!-- 집들이 베스트 최근인기순 -->
    <select id="homeboardBestRecentList" resultType="com.allhomes.myapp.homeboard.HomeboardVO">
    	select b_no, thumbnail, title, userid, hit, scrap, writedate from homeboard where b_no in (select b_no from homeboard where b_no+4 > (select max(b_no) from homeboard)) order by hit desc
    
    </select>
    

  	
</mapper>